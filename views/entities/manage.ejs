<section class="page-header">
  <div>
    <p class="eyebrow">Manage</p>
    <h1><%= title %></h1>
    <p class="muted">Create, update, and browse all <%= title.toLowerCase() %>.</p>
  </div>
  <div class="page-actions">
    <% if (editId) { %>
      <a class="btn" href="<%= currentPath %>">Cancel edit</a>
    <% } %>
  </div>
</section>

<div class="card">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <div class="muted">Showing <%= rows.length %> records</div>
    <div class="chip"><%= title %></div>
  </div>
  <% if (rows && rows.length) { %>
    <table class="data-table">
      <thead>
        <tr>
          <% columns.forEach(col => { %>
            <th><%= col.label %></th>
          <% }); %>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% rows.forEach(row => { %>
          <tr>
            <% columns.forEach(col => { %>
              <td><%= row[col.key] %></td>
            <% }); %>
            <td>
              <div class="row-actions">
                <a class="btn btn-ghost btn-sm" href="<%= currentPath %>?edit=<%= row[idKey] %>"><i class="bi bi-pencil"></i> Edit</a>
                <form method="post" action="<%= currentPath %>/<%= row[idKey] %>?_method=DELETE" onsubmit="return confirm('Delete this record?');">
                  <button type="submit" class="btn btn-ghost btn-sm text-danger"><i class="bi bi-trash"></i> Delete</button>
                </form>
              </div>
            </td>
          </tr>
        <% }); %>
      </tbody>
    </table>
  <% } else { %>
    <div class="muted">No records yet.</div>
  <% } %>
</div>

<div class="card">
  <h3 class="mb-3"><%= formTitle %></h3>
  <form method="post" action="<%= formAction %>">
    <% if (formMethod && formMethod.toUpperCase() !== 'POST') { %>
      <input type="hidden" name="_method" value="<%= formMethod %>">
    <% } %>
    <div class="form-grid">
      <% formFields.forEach(field => { %>
        <div class="form-field">
          <label for="<%= field.name %>"><%= field.label %></label>
          <% if (field.type === 'select') { %>
            <select id="<%= field.name %>" name="<%= field.name %>" <%= field.required ? 'required' : '' %>>
              <option value="">Select...</option>
              <% field.options.forEach(opt => { %>
                <option value="<%= opt.value %>" <%= String(opt.value) === String(field.value) ? 'selected' : '' %>><%= opt.label %></option>
              <% }) %>
            </select>
          <% } else if (field.type === 'textarea') { %>
            <textarea id="<%= field.name %>" name="<%= field.name %>" <%= field.required ? 'required' : '' %>><%= field.value || '' %></textarea>
          <% } else { %>
            <input
              id="<%= field.name %>"
              type="<%= field.type %>"
              name="<%= field.name %>"
              value="<%= field.value || '' %>"
              <%= field.required ? 'required' : '' %>
            />
          <% } %>
        </div>
      <% }); %>
    </div>
    <div class="page-actions mt-3">
      <button type="submit" class="btn btn-primary"><%= formTitle %></button>
      <a class="btn btn-ghost" href="<%= currentPath %>">Reset</a>
    </div>
  </form>
</div>
